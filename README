# Create PKI

sudo apt install easy-rsa
sudo make-cadir /etc/openvpn/easy-rsa
cd /usr/share/easy-rsa/
./easyrsa init-pki
./easyrsa build-ca
12345678

#Your new CA certificate file for publishing is at:
#/usr/share/easy-rsa/pki/ca.crt

./easyrsa gen-req myservername nopass

#Keypair and certificate request completed. Your files are:
#req: /usr/share/easy-rsa/pki/reqs/myservername.req
#key: /usr/share/easy-rsa/pki/private/myservername.key

./easyrsa gen-dh

#DH parameters of size 2048 created at /usr/share/easy-rsa/pki/dh.pem

./easyrsa sign-req server myservername
12345678

#Certificate created at: /usr/share/easy-rsa/pki/issued/myservername.crt

cp pki/dh.pem pki/ca.crt pki/issued/myservername.crt pki/private/myservername.key /root/server

./easyrsa gen-req myclient1 nopass
./easyrsa sign-req client myclient1
12345678

#Certificate created at: /usr/share/easy-rsa/pki/issued/myclient1.crt

./easyrsa gen-req myclient2 nopass && \
./easyrsa sign-req client myclient2

./easyrsa gen-req myclient3 nopass && \
./easyrsa sign-req client myclient3

./easyrsa gen-req myclient4 nopass && \
./easyrsa sign-req client myclient4

./easyrsa gen-req myclient5 nopass && \
./easyrsa sign-req client myclient5

mkdir /root/client
cp /usr/share/easy-rsa/pki/issued/myclient* /root/client/
cp /usr/share/easy-rsa/pki/private/myclient* /root/client/
cp /usr/share/easy-rsa/pki/ca.crt /root/client/
